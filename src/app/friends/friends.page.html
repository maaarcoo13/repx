<ion-header>
  <ion-toolbar class="red-toolbar">
    <ion-buttons slot="start">
      <ion-button routerLink="/profile">
        <img src="assets/icon/profile.png" alt="Profile" class="header-icon" width="63" height="45">
      </ion-button>
      <ion-button routerLink="/groups">
        <img src="assets/icon/groups.png" alt="Groups" class="header-icon" width="57" height="42">
      </ion-button>
      <ion-button routerLink="/friends">
        <img src="assets/icon/friends.png" alt="Friends" class="header-icon" width="65" height="47">
      </ion-button>
    </ion-buttons>

    <ion-title class="center-title">RepX</ion-title>

    <ion-buttons slot="end">
      <ion-button routerLink="/settings">
        <img src="assets/icon/settings.png" alt="Settings" class="header-icon" width="40" height="30">
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <div class="segment-wrapper">
    <ion-segment [(ngModel)]="selectedSegment" mode="md">
      <ion-segment-button value="friends">
        <ion-label>Friends</ion-label>
      </ion-segment-button>
      <ion-segment-button value="groups">
        <ion-label>Groups</ion-label>
      </ion-segment-button>
    </ion-segment>
  </div>

  <!-- FRIENDS VIEW -->
  <div *ngIf="selectedSegment === 'friends'">

    <!-- FRIENDS SEARCH + ADD -->
    <div class="friends-search-wrapper">
      <ion-searchbar 
        [formControl]="searchControl"
        placeholder="Search friends..."
        class="friends-searchbar">
      </ion-searchbar>

      <ion-button (click)="addFriend()" class="add-friend-btn" title="Add friend">
        <img src="assets/icon/plussign.png" alt="plus" class="plus-sign">
      </ion-button>
    </div>


    <section class="friends-section">
      <h2>My Friends ({{ filteredFriends.length }})</h2>

      <div class="friend-card" *ngFor="let friend of filteredFriends">
        <div class="friend-info">
          <img [src]="friend.avatar || 'assets/icon/profile-pic.jpg'" alt="Friend" class="friend-avatar">

          <div class="friend-details">
            <h3>{{ friend.name }}</h3>
            <p class="friend-username">@{{ friend.username }}</p>

            <div class="friend-stats">
              <ion-badge color="danger">{{ friend.rank }}</ion-badge>
              <span class="xp-badge">{{ friend.xp | number }} XP</span>
            </div>
          </div>
        </div>

        <div class="friend-actions">
          <ion-button size="small" fill="clear" color="light" (click)="viewProfile(friend.username)">
            <ion-icon name="person-outline"></ion-icon>
          </ion-button>
          <ion-button size="small" fill="clear" color="light" (click)="openChat(friend.username)">
            <ion-icon name="chatbubble-outline"></ion-icon>
          </ion-button>
        </div>
      </div>
    </section>

    <section class="requests-section" *ngIf="friendRequests.length > 0">
      <h2>Friend Requests ({{ friendRequests.length }})</h2>

      <div class="request-card" *ngFor="let request of friendRequests">
        <img [src]="request.avatar || 'assets/icon/profile-pic.jpg'" alt="Request" class="request-avatar">

        <div class="request-info">
          <h3>{{ request.name }}</h3>
          <p>@{{ request.username }}</p>
        </div>

        <div class="request-actions">
          <ion-button size="small" fill="solid" color="danger" (click)="acceptFriend(request.username)">
            Accept
          </ion-button>
          <ion-button size="small" fill="outline" color="light" (click)="declineFriend(request.username)">
            Decline
          </ion-button>
        </div>
      </div>
    </section>

    <section class="no-requests" *ngIf="friendRequests.length === 0">
      <div class="empty-state">
        <ion-icon name="checkmark-circle-outline" class="empty-icon"></ion-icon>
        <p>No pending friend requests</p>
      </div>
    </section>

  </div>

  <!-- GROUPS VIEW -->
  <div *ngIf="selectedSegment === 'groups'">
    <!-- Aquí va tu código de grupos -->
  </div>

</ion-content>

<ion-footer>
  <ion-toolbar class="bottom-nav-toolbar">
    <ion-buttons class="bottom-nav">
      <ion-button routerLink="/home" class="bottom-nav-btn">Home</ion-button>
      <ion-button routerLink="/routine" class="bottom-nav-btn">Routine</ion-button>
      <ion-button routerLink="/physique" class="bottom-nav-btn">Phy</ion-button>
      <ion-button routerLink="/leaderboard" class="bottom-nav-btn">Leader</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-footer>
